{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Link}from'react-router-dom';import jsPDF from'jspdf';// Detalles de los planes\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PLANES_DETALLE={'Plan Tianlong':['4 horas de billar','2 horas en consolas','Stickers','Descuento en casilleros','Colada morada con guagua'],'Plan Colacuerno':['8 horas de billar','6 horas en consolas','Stickers','50% en casilleros','Termo','1 almuerzo','Gorra','Descuento del 20% en chompas o camisetas','Descuento en cursos ESFOT','Funda de caramelos','Colada morada con guagua','Carnet especial','Canelazo'],'Plan Celestial':['10 horas de billar en el semestre','10 horas en consolas','Stickers','Pin','Casillero gratis','Termo','3 almuerzos en el semestre','Gorra','Camiseta','Descuento del 35% en chompas o camisetas','Descuento en cursos ESFOT','Descuento en tienda','Funda de caramelos','Tarrina de colada morada con su guagua','Regalo sorpresa en Navidad','Entrada a fiestas ESFOT','Carnet especial','Canelazo']};const VisualizarPage=()=>{const[aportaciones,setAportaciones]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const usuarioId=localStorage.getItem('usuarioId');if(!usuarioId){setAportaciones([]);setLoading(false);return;}fetch(`http://localhost:5000/api/planes/usuario/${usuarioId}`).then(res=>res.json()).then(data=>{const planes=data.map(plan=>({fecha:new Date(plan.fechaSeleccion).toISOString().split('T')[0],plan:plan.nombrePlan,estado:plan.estado||'Pendiente'}));setAportaciones(planes);setLoading(false);}).catch(()=>{setAportaciones([]);setLoading(false);});},[]);// Función para generar el PDF\nconst generarReporte=()=>{const doc=new jsPDF();doc.setFontSize(16);doc.text('Factura de Aportaciones ASO-ESFOT',20,20);doc.setFontSize(12);let y=35;aportaciones.forEach((item,idx)=>{var _PLANES_DETALLE$item$;doc.text(`Plan: ${item.plan}`,20,y);doc.text(`Fecha: ${item.fecha}`,20,y+7);doc.text(`Estado: ${item.estado}`,20,y+14);doc.text('Detalles:',20,y+21);(PLANES_DETALLE[item.plan]||[]).forEach((detalle,i)=>{doc.text(`- ${detalle}`,30,y+28+i*7);});y+=28+(((_PLANES_DETALLE$item$=PLANES_DETALLE[item.plan])===null||_PLANES_DETALLE$item$===void 0?void 0:_PLANES_DETALLE$item$.length)||0)*7+10;if(y>270){// Salto de página si es necesario\ndoc.addPage();y=20;}});doc.save('factura_aportaciones.pdf');};return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column min-vh-100\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"bg-esfot text-white py-3 px-4 d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/imagenes_asoesfot/logo.png\",alt:\"ESFOT\",style:{height:'60px'}}),/*#__PURE__*/_jsx(Link,{to:\"/landing\",className:\"btn btn-light\",children:\"Inicio\"})]}),/*#__PURE__*/_jsxs(\"main\",{className:\"flex-grow-1 container py-5\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center mb-4\",children:\"Historial de Aportaciones\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 text-end\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:generarReporte,disabled:aportaciones.length===0,children:\"Generar reporte\"})}),loading?/*#__PURE__*/_jsx(\"p\",{className:\"text-center\",children:\"Cargando...\"}):aportaciones.length>0?/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped shadow\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-dark\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Fecha\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Plan\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Estado\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Detalles del Plan\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:aportaciones.map((item,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.fecha}),/*#__PURE__*/_jsx(\"td\",{children:item.plan}),/*#__PURE__*/_jsx(\"td\",{children:item.estado}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"ul\",{style:{marginBottom:0},children:(PLANES_DETALLE[item.plan]||[]).map((detalle,i)=>/*#__PURE__*/_jsx(\"li\",{children:detalle},i))})})]},index))})]}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-muted\",children:\"No tienes aportaciones registradas.\"})]}),/*#__PURE__*/_jsx(\"footer\",{className:\"bg-esfot text-white text-center py-3\",children:\"\\xA9 2025 ASO-ESFOT. Todos los derechos reservados.\"})]});};export default VisualizarPage;","map":{"version":3,"names":["React","useEffect","useState","Link","jsPDF","jsx","_jsx","jsxs","_jsxs","PLANES_DETALLE","VisualizarPage","aportaciones","setAportaciones","loading","setLoading","usuarioId","localStorage","getItem","fetch","then","res","json","data","planes","map","plan","fecha","Date","fechaSeleccion","toISOString","split","nombrePlan","estado","catch","generarReporte","doc","setFontSize","text","y","forEach","item","idx","_PLANES_DETALLE$item$","detalle","i","length","addPage","save","className","children","src","alt","style","height","to","onClick","disabled","index","marginBottom"],"sources":["C:/Users/PC/Desktop/ASO_ESFOT/frontend/src/pages/VisualizarPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport jsPDF from 'jspdf';\r\n\r\n// Detalles de los planes\r\nconst PLANES_DETALLE = {\r\n  'Plan Tianlong': [\r\n    '4 horas de billar',\r\n    '2 horas en consolas',\r\n    'Stickers',\r\n    'Descuento en casilleros',\r\n    'Colada morada con guagua',\r\n  ],\r\n  'Plan Colacuerno': [\r\n    '8 horas de billar',\r\n    '6 horas en consolas',\r\n    'Stickers',\r\n    '50% en casilleros',\r\n    'Termo',\r\n    '1 almuerzo',\r\n    'Gorra',\r\n    'Descuento del 20% en chompas o camisetas',\r\n    'Descuento en cursos ESFOT',\r\n    'Funda de caramelos',\r\n    'Colada morada con guagua',\r\n    'Carnet especial',\r\n    'Canelazo',\r\n  ],\r\n  'Plan Celestial': [\r\n    '10 horas de billar en el semestre',\r\n    '10 horas en consolas',\r\n    'Stickers',\r\n    'Pin',\r\n    'Casillero gratis',\r\n    'Termo',\r\n    '3 almuerzos en el semestre',\r\n    'Gorra',\r\n    'Camiseta',\r\n    'Descuento del 35% en chompas o camisetas',\r\n    'Descuento en cursos ESFOT',\r\n    'Descuento en tienda',\r\n    'Funda de caramelos',\r\n    'Tarrina de colada morada con su guagua',\r\n    'Regalo sorpresa en Navidad',\r\n    'Entrada a fiestas ESFOT',\r\n    'Carnet especial',\r\n    'Canelazo',\r\n  ],\r\n};\r\n\r\nconst VisualizarPage = () => {\r\n  const [aportaciones, setAportaciones] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const usuarioId = localStorage.getItem('usuarioId');\r\n    if (!usuarioId) {\r\n      setAportaciones([]);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    fetch(`http://localhost:5000/api/planes/usuario/${usuarioId}`)\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        const planes = data.map(plan => ({\r\n          fecha: new Date(plan.fechaSeleccion).toISOString().split('T')[0],\r\n          plan: plan.nombrePlan,\r\n          estado: plan.estado || 'Pendiente',\r\n        }));\r\n        setAportaciones(planes);\r\n        setLoading(false);\r\n      })\r\n      .catch(() => {\r\n        setAportaciones([]);\r\n        setLoading(false);\r\n      });\r\n  }, []);\r\n\r\n  // Función para generar el PDF\r\n  const generarReporte = () => {\r\n    const doc = new jsPDF();\r\n    doc.setFontSize(16);\r\n    doc.text('Factura de Aportaciones ASO-ESFOT', 20, 20);\r\n    doc.setFontSize(12);\r\n\r\n    let y = 35;\r\n    aportaciones.forEach((item, idx) => {\r\n      doc.text(`Plan: ${item.plan}`, 20, y);\r\n      doc.text(`Fecha: ${item.fecha}`, 20, y + 7);\r\n      doc.text(`Estado: ${item.estado}`, 20, y + 14);\r\n      doc.text('Detalles:', 20, y + 21);\r\n      (PLANES_DETALLE[item.plan] || []).forEach((detalle, i) => {\r\n        doc.text(`- ${detalle}`, 30, y + 28 + i * 7);\r\n      });\r\n      y += 28 + (PLANES_DETALLE[item.plan]?.length || 0) * 7 + 10;\r\n      if (y > 270) { // Salto de página si es necesario\r\n        doc.addPage();\r\n        y = 20;\r\n      }\r\n    });\r\n\r\n    doc.save('factura_aportaciones.pdf');\r\n  };\r\n\r\n  return (\r\n    <div className=\"d-flex flex-column min-vh-100\">\r\n      {/* ENCABEZADO */}\r\n      <header className=\"bg-esfot text-white py-3 px-4 d-flex justify-content-between align-items-center\">\r\n        <img src=\"/imagenes_asoesfot/logo.png\" alt=\"ESFOT\" style={{ height: '60px' }} />\r\n        <Link to=\"/landing\" className=\"btn btn-light\">Inicio</Link>\r\n      </header>\r\n\r\n      {/* CUERPO */}\r\n      <main className=\"flex-grow-1 container py-5\">\r\n        <h2 className=\"text-center mb-4\">Historial de Aportaciones</h2>\r\n        <div className=\"mb-3 text-end\">\r\n          <button className=\"btn btn-success\" onClick={generarReporte} disabled={aportaciones.length === 0}>\r\n            Generar reporte\r\n          </button>\r\n        </div>\r\n        {loading ? (\r\n          <p className=\"text-center\">Cargando...</p>\r\n        ) : aportaciones.length > 0 ? (\r\n          <table className=\"table table-striped shadow\">\r\n            <thead className=\"table-dark\">\r\n              <tr>\r\n                <th>Fecha</th>\r\n                <th>Plan</th>\r\n                <th>Estado</th>\r\n                <th>Detalles del Plan</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {aportaciones.map((item, index) => (\r\n                <tr key={index}>\r\n                  <td>{item.fecha}</td>\r\n                  <td>{item.plan}</td>\r\n                  <td>{item.estado}</td>\r\n                  <td>\r\n                    <ul style={{marginBottom: 0}}>\r\n                      {(PLANES_DETALLE[item.plan] || []).map((detalle, i) => (\r\n                        <li key={i}>{detalle}</li>\r\n                      ))}\r\n                    </ul>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        ) : (\r\n          <p className=\"text-center text-muted\">No tienes aportaciones registradas.</p>\r\n        )}\r\n      </main>\r\n\r\n      {/* PIE DE PÁGINA */}\r\n      <footer className=\"bg-esfot text-white text-center py-3\">\r\n        &copy; 2025 ASO-ESFOT. Todos los derechos reservados.\r\n      </footer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VisualizarPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}